{"ast":null,"code":"import _asyncToGenerator from \"/Users/audrian/Documents/Programming/GitHub/banking-app-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { lastValueFrom } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../service/api.service\";\nimport * as i2 from \"src/app/service/auth.service\";\nimport * as i3 from \"@angular/common\";\n\nfunction ViewOffersComponent_div_64_th_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"th\");\n  }\n}\n\nfunction ViewOffersComponent_div_64_tr_22_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\");\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"td\");\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"td\")(14, \"button\", 6);\n    i0.ɵɵlistener(\"click\", function ViewOffersComponent_div_64_tr_22_Template_button_click_14_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r5);\n      const offer_r3 = restoredCtx.$implicit;\n      const ctx_r4 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r4.handleDelete(offer_r3.offerId));\n    });\n    i0.ɵɵtext(15, \"Delete\");\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const offer_r3 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(offer_r3.offerName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(offer_r3.annualFee);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(offer_r3.loanAmnt);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", offer_r3.interestRatePercent, \"%\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(offer_r3.interestFreeCashWithdrawal);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(offer_r3.preclosureCharges);\n  }\n}\n\nfunction ViewOffersComponent_div_64_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8)(1, \"div\", 9)(2, \"h5\", 2);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 10)(5, \"table\", 11)(6, \"thead\")(7, \"tr\")(8, \"th\");\n    i0.ɵɵtext(9, \"Offer Name\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"th\");\n    i0.ɵɵtext(11, \"Annual Fee\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"th\");\n    i0.ɵɵtext(13, \"Loan Amount\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"th\");\n    i0.ɵɵtext(15, \"Interest Rate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"th\");\n    i0.ɵɵtext(17, \"Interest Free Withdrawal\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(18, \"th\");\n    i0.ɵɵtext(19, \"Pre-closure Charges\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(20, ViewOffersComponent_div_64_th_20_Template, 1, 0, \"th\", 12);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(21, \"tbody\");\n    i0.ɵɵtemplate(22, ViewOffersComponent_div_64_tr_22_Template, 16, 6, \"tr\", 13);\n    i0.ɵɵelementEnd()()()()();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate2(\"\", ctx_r0.user == null ? null : ctx_r0.user.customer == null ? null : ctx_r0.user.customer.custFirstName, \" \", ctx_r0.user == null ? null : ctx_r0.user.customer == null ? null : ctx_r0.user.customer.custLastName, \"'s Offers\");\n    i0.ɵɵadvance(17);\n    i0.ɵɵproperty(\"ngIf\", (ctx_r0.listOfOffersByCustId == null ? null : ctx_r0.listOfOffersByCustId.length) !== 0);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.listOfOffersByCustId);\n  }\n}\n\nexport class ViewOffersComponent {\n  constructor(apiService, authService) {\n    this.apiService = apiService;\n    this.authService = authService;\n    this.creditCardOffers = [];\n    this.homeLoanOffers = [];\n    this.carLoanOffers = [];\n    this.offerNames = ['Credit Card', 'Home Loan', 'Car Loan'];\n  }\n\n  ngOnInit() {\n    this.getLoggedInUser().finally(() => {\n      this.getCreditCardOffer(this.user);\n      this.getHomeLoanOffer(this.user);\n      this.getCarLoanOffer(this.user);\n      this.getOffersByCustId(this.user.customer.custId);\n    }); // this.getCreditCardOffer(this.user)\n  }\n\n  getLoggedInUser() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      _this.user = yield lastValueFrom(_this.apiService.getUserByUsername(localStorage.getItem('username')));\n      console.log(_this.user); // console.log(this.authService.test)\n      // this.authService.loggedInUsername$.pipe(tap(username => {\n      //   if(!!username) {\n      //    this.apiService.getUserByUsername(username).subscribe(user => {\n      //     console.log(\"user inisde inner subscribe \" +  user)\n      //     this.user = user\n      //    })\n      //   }\n      // }))\n    })();\n  }\n\n  getCreditCardOffer(user) {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      _this2.creditCardOffer = yield lastValueFrom(_this2.apiService.getCreditCardOffer(user)); // this.creditCardOffers!.push(creditCardOffer)\n\n      _this2.creditCardOffer.custId = user?.customer?.custId;\n      console.log(_this2.creditCardOffer);\n    })();\n  }\n\n  getHomeLoanOffer(user) {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      _this3.homeLoanOffer = yield lastValueFrom(_this3.apiService.getHomeLoanOffer(user)); // this.homeLoanOffers!.push(homeLoanOffer)\n\n      console.log(_this3.homeLoanOffer);\n    })();\n  }\n\n  getCarLoanOffer(user) {\n    var _this4 = this;\n\n    return _asyncToGenerator(function* () {\n      _this4.carLoanOffer = yield lastValueFrom(_this4.apiService.getCarLoanOffer(user)); // this.carLoanOffers!.push(carLoanOffer)\n\n      console.log(_this4.carLoanOffer);\n    })();\n  } // testButton() {\n  //   // this.getCreditCardOffer(this.user)\n  //   // this.getHomeLoanOffer(this.user)\n  //   this.getCarLoanOffer(this.user);\n  // }\n\n\n  applyCreditCard(creditCardOffer) {\n    var _this5 = this;\n\n    return _asyncToGenerator(function* () {\n      creditCardOffer.custId = _this5.user.customer.custId;\n      console.log(creditCardOffer);\n      creditCardOffer = yield lastValueFrom(_this5.apiService.saveOffer(creditCardOffer));\n\n      _this5.getOffersByCustId(_this5.user?.customer?.custId);\n    })();\n  }\n\n  applyHomeLoan(homeLoanOffer) {\n    var _this6 = this;\n\n    return _asyncToGenerator(function* () {\n      homeLoanOffer.custId = _this6.user.customer.custId;\n      homeLoanOffer = yield lastValueFrom(_this6.apiService.saveOffer(homeLoanOffer));\n\n      _this6.getOffersByCustId(_this6.user?.customer?.custId);\n    })();\n  }\n\n  applyCarLoan(carLoanOffer) {\n    var _this7 = this;\n\n    return _asyncToGenerator(function* () {\n      carLoanOffer.custId = _this7.user.customer.custId;\n      carLoanOffer = yield lastValueFrom(_this7.apiService.saveOffer(carLoanOffer));\n\n      _this7.getOffersByCustId(_this7.user?.customer?.custId);\n    })();\n  }\n\n  getOffersByCustId(custId) {\n    var _this8 = this;\n\n    return _asyncToGenerator(function* () {\n      _this8.listOfOffersByCustId = yield lastValueFrom(_this8.apiService.getOffersByCustId(custId));\n      console.log(_this8.listOfOffersByCustId);\n    })();\n  }\n\n  handleDelete(offerId) {\n    var _this9 = this;\n\n    return _asyncToGenerator(function* () {\n      yield lastValueFrom(_this9.apiService.delOffersById(offerId));\n\n      _this9.getOffersByCustId(_this9.user?.customer?.custId);\n    })();\n  }\n\n}\n\nViewOffersComponent.ɵfac = function ViewOffersComponent_Factory(t) {\n  return new (t || ViewOffersComponent)(i0.ɵɵdirectiveInject(i1.ApiService), i0.ɵɵdirectiveInject(i2.AuthService));\n};\n\nViewOffersComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: ViewOffersComponent,\n  selectors: [[\"app-view-offers\"]],\n  decls: 65,\n  vars: 13,\n  consts: [[1, \"d-flex\", \"justify-content-around\"], [1, \"d-flex\", \"flex-column\", \"w-25\", \"shadow\", 2, \"border-radius\", \"16px\"], [1, \"bg\", \"bg-dark\", \"text-white\", \"text-center\", \"py-2\", 2, \"border-top-left-radius\", \"16px\", \"border-top-right-radius\", \"16px\"], [1, \"d-flex\", \"ms-2\"], [1, \"mb-0\", \"ms-2\"], [1, \"align-self-center\", \"mb-2\"], [1, \"rounded-pill\", 3, \"click\"], [\"class\", \"d-flex justify-content-center mt-5 mb-4\", 4, \"ngIf\"], [1, \"d-flex\", \"justify-content-center\", \"mt-5\", \"mb-4\"], [1, \"d-flex\", \"flex-column\", \"shadow\", 2, \"border-radius\", \"16px\"], [1, \"px-5\", \"py-3\", \"table-responsive\"], [1, \"table\", \"table-bordered\", \"table-striped\", \"table-hover\", \"align-middle\"], [4, \"ngIf\"], [4, \"ngFor\", \"ngForOf\"]],\n  template: function ViewOffersComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"h5\", 2);\n      i0.ɵɵtext(3);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(4, \"div\", 3)(5, \"h6\");\n      i0.ɵɵtext(6, \"Annual Fee:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(7, \"p\", 4);\n      i0.ɵɵtext(8);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(9, \"div\", 3)(10, \"h6\");\n      i0.ɵɵtext(11, \"Interest Rate:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(12, \"p\", 4);\n      i0.ɵɵtext(13);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(14, \"div\", 3)(15, \"h6\");\n      i0.ɵɵtext(16, \"Interest Free Withdrawal:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(17, \"p\", 4);\n      i0.ɵɵtext(18);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(19, \"div\", 5)(20, \"button\", 6);\n      i0.ɵɵlistener(\"click\", function ViewOffersComponent_Template_button_click_20_listener() {\n        return ctx.applyCreditCard(ctx.creditCardOffer);\n      });\n      i0.ɵɵtext(21, \" Apply \");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(22, \"div\", 1)(23, \"h5\", 2);\n      i0.ɵɵtext(24);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(25, \"div\", 3)(26, \"h6\");\n      i0.ɵɵtext(27, \"Loan Amount:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(28, \"p\", 4);\n      i0.ɵɵtext(29);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(30, \"div\", 3)(31, \"h6\");\n      i0.ɵɵtext(32, \"Interest Rate:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(33, \"p\", 4);\n      i0.ɵɵtext(34);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(35, \"div\", 3)(36, \"h6\");\n      i0.ɵɵtext(37, \"Pre-closure Charges:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(38, \"p\", 4);\n      i0.ɵɵtext(39);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(40, \"div\", 5)(41, \"button\", 6);\n      i0.ɵɵlistener(\"click\", function ViewOffersComponent_Template_button_click_41_listener() {\n        return ctx.applyHomeLoan(ctx.homeLoanOffer);\n      });\n      i0.ɵɵtext(42, \" Apply \");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(43, \"div\", 1)(44, \"h5\", 2);\n      i0.ɵɵtext(45);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(46, \"div\", 3)(47, \"h6\");\n      i0.ɵɵtext(48, \"Loan Amount:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(49, \"p\", 4);\n      i0.ɵɵtext(50);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(51, \"div\", 3)(52, \"h6\");\n      i0.ɵɵtext(53, \"Interest Rate:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(54, \"p\", 4);\n      i0.ɵɵtext(55);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(56, \"div\", 3)(57, \"h6\");\n      i0.ɵɵtext(58, \"Pre-closure Charges:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(59, \"p\", 4);\n      i0.ɵɵtext(60);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(61, \"div\", 5)(62, \"button\", 6);\n      i0.ɵɵlistener(\"click\", function ViewOffersComponent_Template_button_click_62_listener() {\n        return ctx.applyCarLoan(ctx.carLoanOffer);\n      });\n      i0.ɵɵtext(63, \" Apply \");\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵtemplate(64, ViewOffersComponent_div_64_Template, 23, 4, \"div\", 7);\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(3);\n      i0.ɵɵtextInterpolate1(\" \", ctx.creditCardOffer == null ? null : ctx.creditCardOffer.offerName, \" \");\n      i0.ɵɵadvance(5);\n      i0.ɵɵtextInterpolate1(\"$\", ctx.creditCardOffer == null ? null : ctx.creditCardOffer.annualFee, \"\");\n      i0.ɵɵadvance(5);\n      i0.ɵɵtextInterpolate1(\"\", ctx.creditCardOffer == null ? null : ctx.creditCardOffer.interestRatePercent, \"%\");\n      i0.ɵɵadvance(5);\n      i0.ɵɵtextInterpolate1(\" $\", ctx.creditCardOffer == null ? null : ctx.creditCardOffer.interestFreeCashWithdrawal, \" \");\n      i0.ɵɵadvance(6);\n      i0.ɵɵtextInterpolate1(\" \", ctx.homeLoanOffer == null ? null : ctx.homeLoanOffer.offerName, \" \");\n      i0.ɵɵadvance(5);\n      i0.ɵɵtextInterpolate1(\"$\", ctx.homeLoanOffer == null ? null : ctx.homeLoanOffer.loanAmnt, \"\");\n      i0.ɵɵadvance(5);\n      i0.ɵɵtextInterpolate1(\"\", ctx.homeLoanOffer == null ? null : ctx.homeLoanOffer.interestRatePercent, \"%\");\n      i0.ɵɵadvance(5);\n      i0.ɵɵtextInterpolate1(\"$\", ctx.homeLoanOffer == null ? null : ctx.homeLoanOffer.preclosureCharges, \"\");\n      i0.ɵɵadvance(6);\n      i0.ɵɵtextInterpolate1(\" \", ctx.carLoanOffer == null ? null : ctx.carLoanOffer.offerName, \" \");\n      i0.ɵɵadvance(5);\n      i0.ɵɵtextInterpolate1(\"$\", ctx.carLoanOffer == null ? null : ctx.carLoanOffer.loanAmnt, \"\");\n      i0.ɵɵadvance(5);\n      i0.ɵɵtextInterpolate1(\"\", ctx.carLoanOffer == null ? null : ctx.carLoanOffer.interestRatePercent, \"%\");\n      i0.ɵɵadvance(5);\n      i0.ɵɵtextInterpolate1(\"$\", ctx.carLoanOffer == null ? null : ctx.carLoanOffer.preclosureCharges, \"\");\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngIf\", (ctx.listOfOffersByCustId == null ? null : ctx.listOfOffersByCustId.length) !== 0);\n    }\n  },\n  dependencies: [i3.NgForOf, i3.NgIf],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJ2aWV3LW9mZmVycy5jb21wb25lbnQuY3NzIn0= */\"]\n});","map":{"version":3,"mappings":"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","names":["lastValueFrom","i0","ViewOffersComponent","constructor","apiService","authService","ngOnInit","getLoggedInUser","finally","getCreditCardOffer","user","getHomeLoanOffer","getCarLoanOffer","getOffersByCustId","customer","custId","getUserByUsername","localStorage","getItem","console","log","creditCardOffer","homeLoanOffer","carLoanOffer","applyCreditCard","saveOffer","applyHomeLoan","applyCarLoan","listOfOffersByCustId","handleDelete","offerId","delOffersById","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["/Users/audrian/Documents/Programming/GitHub/banking-app-angular/src/app/pages/view-offers/view-offers.component.ts","/Users/audrian/Documents/Programming/GitHub/banking-app-angular/src/app/pages/view-offers/view-offers.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { lastValueFrom, tap } from 'rxjs';\nimport { AuthService } from 'src/app/service/auth.service';\nimport { Offer } from '../../models/offer';\nimport { User } from '../../models/user';\nimport { ApiService } from '../../service/api.service';\n\n@Component({\n  selector: 'app-view-offers',\n  templateUrl: './view-offers.component.html',\n  styleUrls: ['./view-offers.component.css'],\n})\nexport class ViewOffersComponent implements OnInit {\n  \n  listOfOffersByCustId?: Offer[]\n  \n  creditCardOffers?: Offer[] = [];\n  homeLoanOffers?: Offer[] = [];\n  carLoanOffers?: Offer[] = [];\n\n  creditCardOffer?: Offer;\n  homeLoanOffer?: Offer;\n  carLoanOffer?: Offer;\n\n  user?: User;\n  offerNames = ['Credit Card', 'Home Loan', 'Car Loan'];\n\n  constructor(private apiService: ApiService, private authService: AuthService) {}\n\n  ngOnInit(): void {\n    this.getLoggedInUser().finally(() => {\n      this.getCreditCardOffer(this.user);\n      this.getHomeLoanOffer(this.user);\n      this.getCarLoanOffer(this.user);\n      this.getOffersByCustId(this.user!.customer!.custId)\n    });\n    // this.getCreditCardOffer(this.user)\n  }\n\n  async getLoggedInUser() {\n    this.user = (await lastValueFrom(\n      this.apiService.getUserByUsername(localStorage.getItem('username'))\n    )) as User;\n    console.log(this.user);\n    // console.log(this.authService.test)\n\n    // this.authService.loggedInUsername$.pipe(tap(username => {\n    //   if(!!username) {\n    //    this.apiService.getUserByUsername(username).subscribe(user => {\n    //     console.log(\"user inisde inner subscribe \" +  user)\n    //     this.user = user\n    //    })\n    //   }\n    // }))\n  }\n\n  async getCreditCardOffer(user: User | null | undefined) {\n    this.creditCardOffer = (await lastValueFrom(\n      this.apiService.getCreditCardOffer(user)\n    )) as Offer;\n    // this.creditCardOffers!.push(creditCardOffer)\n    this.creditCardOffer.custId = user?.customer?.custId;\n    console.log(this.creditCardOffer);\n  }\n\n  async getHomeLoanOffer(user: User | null | undefined) {\n    this.homeLoanOffer = (await lastValueFrom(\n      this.apiService.getHomeLoanOffer(user)\n    )) as Offer;\n    // this.homeLoanOffers!.push(homeLoanOffer)\n    console.log(this.homeLoanOffer);\n  }\n\n  async getCarLoanOffer(user: User | null | undefined) {\n    this.carLoanOffer = (await lastValueFrom(\n      this.apiService.getCarLoanOffer(user)\n    )) as Offer;\n    // this.carLoanOffers!.push(carLoanOffer)\n    console.log(this.carLoanOffer);\n  }\n\n  // testButton() {\n  //   // this.getCreditCardOffer(this.user)\n  //   // this.getHomeLoanOffer(this.user)\n  //   this.getCarLoanOffer(this.user);\n  // }\n\n  async applyCreditCard(creditCardOffer: Offer | null | undefined) {\n    creditCardOffer!.custId = this.user!.customer!.custId\n    console.log(creditCardOffer)\n    creditCardOffer = await lastValueFrom(this.apiService.saveOffer(creditCardOffer)) as Offer\n    this.getOffersByCustId(this.user?.customer?.custId)\n  }\n\n  async applyHomeLoan(homeLoanOffer: Offer | null | undefined) {\n    homeLoanOffer!.custId = this.user!.customer!.custId\n    homeLoanOffer = await lastValueFrom(this.apiService.saveOffer(homeLoanOffer)) as Offer\n    this.getOffersByCustId(this.user?.customer?.custId)\n  }\n\n  async applyCarLoan(carLoanOffer: Offer | null | undefined) {\n    carLoanOffer!.custId = this.user!.customer!.custId\n    carLoanOffer = await lastValueFrom(this.apiService.saveOffer(carLoanOffer)) as Offer\n    this.getOffersByCustId(this.user?.customer?.custId)\n  }\n\n  async getOffersByCustId(custId: number | null | undefined) {\n    this.listOfOffersByCustId = await lastValueFrom(this.apiService.getOffersByCustId(custId)) as Offer[]\n    console.log(this.listOfOffersByCustId)\n  }\n\n  async handleDelete(offerId: number |null |undefined) {\n    await lastValueFrom(this.apiService.delOffersById(offerId))\n    this.getOffersByCustId(this.user?.customer?.custId)\n  }\n\n}\n","<div class=\"d-flex justify-content-around\">\n  <div class=\"d-flex flex-column w-25 shadow\" style=\"border-radius: 16px\">\n    <h5\n      class=\"bg bg-dark text-white text-center py-2\"\n      style=\"border-top-left-radius: 16px; border-top-right-radius: 16px\"\n    >\n      {{ creditCardOffer?.offerName }}\n    </h5>\n    <div class=\"d-flex ms-2\">\n      <h6>Annual Fee:</h6>\n      <p class=\"mb-0 ms-2\">${{ creditCardOffer?.annualFee }}</p>\n    </div>\n    <div class=\"d-flex ms-2\">\n      <h6>Interest Rate:</h6>\n      <p class=\"mb-0 ms-2\">{{ creditCardOffer?.interestRatePercent }}%</p>\n    </div>\n    <div class=\"d-flex ms-2\">\n      <h6>Interest Free Withdrawal:</h6>\n      <p class=\"mb-0 ms-2\">\n        ${{ creditCardOffer?.interestFreeCashWithdrawal }}\n      </p>\n    </div>\n    <div class=\"align-self-center mb-2\">\n      <button class=\"rounded-pill\" (click)=\"applyCreditCard(creditCardOffer)\">\n        Apply\n      </button>\n    </div>\n  </div>\n  <div class=\"d-flex flex-column w-25 shadow\" style=\"border-radius: 16px\">\n    <h5\n      class=\"bg bg-dark text-white text-center py-2\"\n      style=\"border-top-left-radius: 16px; border-top-right-radius: 16px\"\n    >\n      {{ homeLoanOffer?.offerName }}\n    </h5>\n    <div class=\"d-flex ms-2\">\n      <h6>Loan Amount:</h6>\n      <p class=\"mb-0 ms-2\">${{ homeLoanOffer?.loanAmnt }}</p>\n    </div>\n    <div class=\"d-flex ms-2\">\n      <h6>Interest Rate:</h6>\n      <p class=\"mb-0 ms-2\">{{ homeLoanOffer?.interestRatePercent }}%</p>\n    </div>\n    <div class=\"d-flex ms-2\">\n      <h6>Pre-closure Charges:</h6>\n      <p class=\"mb-0 ms-2\">${{ homeLoanOffer?.preclosureCharges }}</p>\n    </div>\n    <div class=\"align-self-center mb-2\">\n      <button class=\"rounded-pill\" (click)=\"applyHomeLoan(homeLoanOffer)\">\n        Apply\n      </button>\n    </div>\n  </div>\n  <div class=\"d-flex flex-column w-25 shadow\" style=\"border-radius: 16px\">\n    <h5\n      class=\"bg bg-dark text-white text-center py-2\"\n      style=\"border-top-left-radius: 16px; border-top-right-radius: 16px\"\n    >\n      {{ carLoanOffer?.offerName }}\n    </h5>\n    <div class=\"d-flex ms-2\">\n      <h6>Loan Amount:</h6>\n      <p class=\"mb-0 ms-2\">${{ carLoanOffer?.loanAmnt }}</p>\n    </div>\n    <div class=\"d-flex ms-2\">\n      <h6>Interest Rate:</h6>\n      <p class=\"mb-0 ms-2\">{{ carLoanOffer?.interestRatePercent }}%</p>\n    </div>\n    <div class=\"d-flex ms-2\">\n      <h6>Pre-closure Charges:</h6>\n      <p class=\"mb-0 ms-2\">${{ carLoanOffer?.preclosureCharges }}</p>\n    </div>\n    <div class=\"align-self-center mb-2\">\n      <button class=\"rounded-pill\" (click)=\"applyCarLoan(carLoanOffer)\">\n        Apply\n      </button>\n    </div>\n  </div>\n</div>\n<div *ngIf=\"listOfOffersByCustId?.length !== 0\" class=\"d-flex justify-content-center mt-5 mb-4\">\n  <div class=\"d-flex flex-column shadow\" style=\"border-radius: 16px;\">\n    <h5 class=\"bg bg-dark text-white text-center py-2\" style=\"border-top-left-radius: 16px; border-top-right-radius: 16px\">{{user?.customer?.custFirstName}} {{user?.customer?.custLastName}}'s Offers</h5>\n    <div class=\"px-5 py-3 table-responsive\">\n      <table\n        class=\"table table-bordered table-striped table-hover align-middle\"\n      >\n        <thead>\n          <tr>\n            <th>Offer Name</th>\n            <th>Annual Fee</th>\n            <th>Loan Amount</th>\n            <th>Interest Rate</th>\n            <th>Interest Free Withdrawal</th>\n            <th>Pre-closure Charges</th>\n            <th *ngIf=\"listOfOffersByCustId?.length !== 0\" ></th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr *ngFor=\"let offer of listOfOffersByCustId\">\n            <td>{{ offer.offerName }}</td>\n            <td>{{ offer.annualFee }}</td>\n            <td>{{ offer.loanAmnt }}</td>\n            <td>{{ offer.interestRatePercent }}%</td>\n            <td>{{ offer.interestFreeCashWithdrawal }}</td>\n            <td>{{ offer.preclosureCharges }}</td>\n            <td><button class=\"rounded-pill\" (click)=\"handleDelete(offer.offerId)\">Delete</button></td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n    <!-- <button *ngFor=\"let names\"></button> -->\n    <!-- <button (click)=\"testButton()\">click</button> -->\n  </div>\n</div>\n"]},"metadata":{},"sourceType":"module"}